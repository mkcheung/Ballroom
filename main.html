<!DOCTYPE HTML>
<html>
 <head>
  	<meta charset="UTF-8">
	<meta name="format-detection" content="telephone-no">
	<meta name="viewport" content="user-scalable=no, initial-scale=1, minimum-scale=1, maximum-scale=1, width=device-width, height=device-height">
 	<link rel="stylesheet" href="css/jquery.mobile-1.3.1.css">
	<link rel="stylesheet" href="css/jquery.mobile.structure-1.3.1.css">
	<link rel="stylesheet" href="css/jquery.mobile.theme-1.3.1.css">
  	<script type="text/javascript" charset="utf-8" src="js/jquery-1.10.1.min.js"></script>
  	<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
  	<script type="text/javascript" charset="utf-8" src="js/html5sql.js"></script>
 	<script type="text/javascript" charset="utf-8" src="js/jquery.mobile-1.3.1.js"></script>
  	<script type="text/javascript" charset="utf-8" src="js/databaseSetup.js"></script>
 
 	<script>
 		selector = 0;
 		danceId = 0;
 		danceLevelId = 0;
 		function onBodyLoad(){
 			document.addEventListener("deviceready", onDeviceReady, false);
 		}
 		function onDeviceReady(){
 			//checkDB();
 			//dropDB();
 			//newRoutine(1,1);
 			//listRoutines();
 		}
 	</script>
 </head>
 <body id="ballroomAppBody" onload="onBodyLoad()">
	 <div id="main" data-role="page">
	  	<div data-role="header" data-position="fixed">
	  		<h1>Dance Selector</h1>
	  	</div>
	  	<div data-role="content">
	  		<ul data-role="listview">
	  			<li data-pageLink="#buildRoutine">
	  				Build a Routine
	  			</li>
	  			<li data-pageLink="#seeRoutines">
	  				Saved Routines
	  			</li>
	  		</ul>
	  	</div>
	  	<div data-role="footer" data-position="fixed">
	  	</div>
	 </div>
	 
		<script>
	 		$('#main').on('vclick','li' ,function(){
				var destinationPage = $(this).attr('data-pageLink');
				if(destinationPage == "#seeRoutines"){
					listRoutines('#listOfAllRoutines');
				}
		        $.mobile.changePage(destinationPage);
		    });
		</script>
	 
  <div id="buildRoutine" data-role="page">
  	<div data-role="header" data-position="fixed">
  		<h1>Dance Selector</h1>
  	</div>
  	<div data-role="content">
	  	<div id="dancesAndLevels" data-role="collapsible-set" data-theme="c" data-content-theme="d" data-mini="true">
	 		<div data-role="collapsible">
		    	<h1>Waltz</h1>
		 		<ul data-role="listview" data-inset="true">
					<li data-danceId="1" data-danceLevelId="1" data-pageLink="#Waltz-PreBronze">
						Pre-Bronze / Student Teacher
					</li>
					<li data-danceId="1" data-danceLevelId="2" data-pageLink="#Waltz-Bronze">
						Bronze / Associate
					</li>
					<li data-danceId="1" data-danceLevelId="3">
						Silver / Licentiate
					</li>
					<li>
						<a href="#Waltz-Gold">Gold / Fellow</a>
					</li>
		 		</ul>
	 		</div>
	 		<div data-role="collapsible">
		    	<h1>Tango</h1>
		 		<ul data-role="listview" data-inset="true">
					<li>
						<a href="#">Pre-Bronze / Student Teacher</a>
					</li>
					<li>
						<a href="#">Bronze / Associate</a>
					</li>
					<li>
						<a href="#">Silver / Licentiate</a>
					</li>
					<li>
						<a href="#">Gold / Fellow</a>
					</li>
		 		</ul>
	 		</div>
	 		<div data-role="collapsible">
		    	<h1>Viennese Waltz</h1>
		 		<ul data-role="listview" data-inset="true">
					<li data-danceId="3" data-pageLink="#VienneseWaltz-Bronze">
						Bronze / Associate
					</li>
					<li>
						<a href="#">Silver / Licentiate</a>
					</li>
					<li>
						<a href="#">Gold / Fellow</a>
					</li>
		 		</ul>
	 		</div>
	 		<div data-role="collapsible">
		    	<h1>Foxtrot</h1>
		 		<ul data-role="listview" data-inset="true">
					<li>
						<a href="#">Pre-Bronze / Student Teacher</a>
					</li>
					<li>
						<a href="#">Bronze / Associate</a>
					</li>
					<li>
						<a href="#">Silver / Licentiate</a>
					</li>
					<li>
						<a href="#">Gold / Fellow</a>
					</li>
		 		</ul>
	 		</div>
	 		<div data-role="collapsible">
		    	<h1>Quickstep</h1>
		 		<ul data-role="listview" data-inset="true">
					<li>
						<a href="#">Pre-Bronze / Student Teacher</a>
					</li>
					<li>
						<a href="#">Bronze / Associate</a>
					</li>
					<li>
						<a href="#">Silver / Licentiate</a>
					</li>
					<li>
						<a href="#">Gold / Fellow</a>
					</li>
		 		</ul>
	 		</div>
	 	</div>
		<script>
	 		$('#dancesAndLevels li').on("vclick",function(){
		        danceId = $(this).attr("data-danceId");
		        danceLevelId = $(this).attr("data-danceLevelId");
		        localStorage.pageLink = $(this).attr("data-pageLink");
		        //alert(danceId);
		        //alert(danceLevelId);
		        //alert(localStorage.pageLink);
		        $.mobile.changePage('#routineNaming-Dialog', {transition: 'slidedown', role: 'dialog'});
		    });
		</script>
	</div>
  	<div data-role="footer" data-position="fixed">
  		<h1>Dance Selector</h1>
  	</div>
  </div>
  
  	 
  <div id="seeRoutines" data-role="page">
  	<div data-role="header" data-position="fixed">
  		<h1>Routines</h1>
  	</div>
  	<div data-role="content">
  		<ul id="listOfAllRoutines" data-role="listview" data-inset="true">

  		</ul>
  	</div>
  	<div data-role="footer" data-position="fixed">
  		<h1>Routines</h1>
  	</div>
  </div>
  <script>
	$('#seeRoutines').on('pagebeforeshow', listRoutines('#listOfAllRoutines'));
	$('#ballroomAppBody').on('vclick', '#listOfAllRoutines li', function(){
		selector = parseInt($(this).attr('id'));
		alert(selector);
		alert(typeof selector);
		showStepsInRoutine(selector, '#listOfAllStepsInRoutine')
		$.mobile.changePage('#seeStepsInRoutine');
	});
  </script>	 
  
  <div id="seeStepsInRoutine" data-role="page">
  	<div data-role="header" data-position="fixed">
  		<h1>Steps In Routine</h1>
  	</div>
  	<div data-role="content">
  		<ul id="listOfAllStepsInRoutine" data-role="listview" data-inset="true">

  		</ul>
  	</div>
  	<div data-role="footer" data-position="fixed">
  		<h1>Steps In Routine</h1>
  	</div>
  </div>
  <script>
	$('#seeStepsInRoutine').on('pagebeforeshow', $('#listOfAllStepsInRoutine').listview('refresh'));
  </script>
  
  
   <div id="routineNaming-Dialog" data-role="page">
 	<div data-role="header" data-position="fixed">
  		<h1>Dialog</h1>
  	</div>
  	<div data-role="content">
  		<label for="routineName">Please enter a name for the routine:</label>
  		<input type="text" id="routineName"></input>
  		<input id="nameARoutine" type="button" data-role="button" data-theme="e" value="Routine Name"></input>
 		<script>
  			$('#nameARoutine').on("tap", function(){
  				newRoutineName = $('#routineName').val();
  		  		//$('#routineNaming-Dialog').dialog('close');
  		  		nameRoutine(newRoutineName);
  			    //alert('prior to redirect: ' + localStorage.pageLink);
  			    routineStepList = '#' + localStorage.pageLink.substring(1, localStorage.pageLink.length) + '-NewRoutine-list';
  			    initialStepPanelList = '#' + localStorage.pageLink.substring(1, localStorage.pageLink.length) + '-panel-list';
  			    //alert(routineStepList);
  			    //check class to see if the listview has been initialized
  			    if($(routineStepList).hasClass('ui-listview')){
  			    	$(routineStepList).empty();
  	  			    $(routineStepList).listview('refresh');	
  			    }
  			    if($(initialStepPanelList).hasClass('ui-listview')){
  			    	$(initialStepPanelList).empty();
  	  			    $(initialStepPanelList).listview('refresh');	
  			    }
  			  	newRoutine(danceId, danceLevelId, initialStepPanelList);
  		  	  	$.mobile.changePage(localStorage.pageLink);
  		  	});
	  	</script>
	</div>
  	<div data-role="footer" data-position="fixed">
  		<h1>Dialog</h1>
  	</div>
  </div>
  
  <div id="Waltz-PreBronze" data-role="page">
  	<div data-role="panel" id="Waltz-PreBronze-panel">
		<ul data-role="listview" data-inset="true" id="Waltz-PreBronze-panel-list">
	 	</ul>
	</div>
 	<div data-role="header" data-position="fixed">
  		<h1>Waltz-PreBronze</h1>
  		<a href="#main" data-icon="gear" class="ui-btn-right">Home</a>
  	</div>
  	<div data-role="content">
  		<a href="#Waltz-PreBronze-panel" data-role="button">Add Step</a>
  		<ul data-role="listview" data-inset="true" id="Waltz-PreBronze-NewRoutine-list">
  		</ul>
	</div>
  	<div data-role="footer" data-position="fixed">
  		<h1>Waltz-PreBronze</h1>
  	</div>
  </div>
  <script>
  	$('#ballroomAppBody').on('vclick', '#Waltz-PreBronze-panel-list li', function(){
  		addToRoutine(localStorage.newRoutineIndex, $(this).attr('data-stepid'));
  		showStepsInRoutine(localStorage.newRoutineIndex, '#Waltz-PreBronze-NewRoutine-list');
  		//alert($(this).attr('data-stepid'));
  	});
  </script>
  
  
  <div id="Waltz-Bronze" data-role="page">
  	<div data-role="panel" id="Waltz-Bronze-panel">
		<ul data-role="listview" data-inset="true" id="Waltz-Bronze-panel-list">
	 	</ul>
	</div>
 	<div data-role="header" data-position="fixed">
  		<h1>Waltz-Bronze</h1>
  		<a href="#main" data-icon="gear" class="ui-btn-right">Home</a>
  	</div>
  	<div data-role="content">
  		<a href="#Waltz-Bronze-panel" data-role="button">Add Step</a>
	</div>
  	<div data-role="footer" data-position="fixed">
  		<h1>Waltz-Bronze</h1>
  	</div>
  </div>
	<script>
		//$('#Waltz-Bronze').on('pagebeforeshow', newRoutine(danceId, danceLevelId, '#Waltz-Bronze-panel-list'));
	</script>
  
  <div id="VienneseWaltz-Bronze" data-role="page">
  	<div data-role="panel" id="VienneseWaltz-Bronze-panel">
		<ul data-role="listview" data-inset="true" id="VienneseWaltz-Bronze-panel-list">
	 	</ul>
		<a href="#" data-role="button" data-inline="true" data-theme="b">Delete Step</a>
	</div>
 	<div data-role="header" data-position="fixed">
  		<h1>VienneseWaltz-Bronze</h1>
  		<a href="#main" data-icon="gear" class="ui-btn-right">Home</a>
  	</div>
  	<div data-role="content">
  		<a href="#VienneseWaltz-Bronze-panel" data-role="button">Add Step</a>
  		<ul data-role="listview" data-inset="true" id="VienneseWaltz-Bronze-NewRoutine-list">
  		</ul>
	</div>
  	<div data-role="footer" data-position="fixed">
  		<h1>VienneseWaltz-Bronze</h1>
  	</div>
  </div>
  <script>
  	$('#ballroomAppBody').on('vclick', '#VienneseWaltz-Bronze-panel-list li', function(){
  		addToRoutine(localStorage.newRoutineIndex, $(this).attr('data-stepid'),'#VienneseWaltz-Bronze-panel-list');
  		showStepsInRoutine(localStorage.newRoutineIndex, '#VienneseWaltz-Bronze-NewRoutine-list');
  	});
  </script>
 </body>
</html>